<!-- Candidate card for list view -->
<div
  class="candidate-card p-4 border rounded-lg cursor-pointer bg-white hover:bg-blue-50 transition"
  data-candidate-id="{% if candidate.chat_id %}{{ candidate.chat_id }}{% else %}recommend_{{ candidate.index }}{% endif %}"
  hx-get="/candidates/detail"
  hx-vals='{{ candidate | tojson }}'
  hx-target="#detail-pane"
  hx-include="#job-selector,#threshold-chat,#threshold-borderline,#threshold-seek,#analysis,#resume_text,#full_resume,#message-content"
  hx-on::click="console.log('Candidate clicked:', JSON.parse(this.dataset.candidate));"
>
  <div class="flex items-start space-x-3 relative">
    <!-- hidden data:
      - "analysis": analysis,
      - "resume_text": resume_text,
      - "full_resume": full_resume,
    -->
    <input type="hidden" name="analysis" value="{{ analysis | tojson }}">
    <input type="hidden" name="resume_text" value="{{ resume_text }}">
    <input type="hidden" name="full_resume" value="{{ full_resume }}">
    <!-- Score badge in upper-right corner -->
    {% if candidate.score is defined and candidate.score is not none %}
    <div class="absolute top-0 right-0 bg-gradient-to-r from-blue-500 to-indigo-600 text-white text-xs font-bold px-2 py-1 rounded-bl-lg rounded-tr-lg shadow-md" data-badge="score">
      {{ candidate.score }}
    </div>
    {% endif %}
    <!-- avatar -->
    <div class="flex-shrink-0">
      <div
        class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center"
      >
        <span class="text-lg">ğŸ‘¤</span>
      </div>
    </div>
    <!-- name and job applied -->
    <div class="flex-1 min-w-0">
      <h3 class="font-bold text-gray-900 truncate">
        {{ candidate.name or 'æœªçŸ¥' }}
      </h3>
      <p class="text-sm text-gray-600 truncate">
        {{ candidate.job_applied or 'æœªæŒ‡å®šå²—ä½' }}
      </p>
      <!-- last message -->
      <p class="text-xs text-gray-500 mt-1 line-clamp-2">
        {{ candidate.last_message or 'æš‚æ— æ¶ˆæ¯' }}
      </p>
      <!-- tags: viewed, greeted, saved -->
      <div class="mt-2 flex flex-wrap gap-1">
        {% if candidate.viewed is defined and candidate.viewed %}
        <span
          class="inline-block px-2 py-1 text-xs rounded-full bg-purple-100 text-purple-700"
          data-tag="viewed"
        >
          ğŸ‘ï¸ å·²æŸ¥çœ‹
        </span>
        {% endif %}
        {% if candidate.greeted is defined and candidate.greeted %}
        <span
          class="inline-block px-2 py-1 text-xs rounded-full bg-green-100 text-green-700"
        >
          ğŸ‘‹ å·²æ‰“æ‹›å‘¼
        </span>
        {% endif %}
        {% if candidate.saved %}
        <span
          class="inline-block px-2 py-1 text-xs rounded-full bg-blue-100 text-blue-700"
          data-tag="saved"
        >
          ğŸ’¾ å·²ä¿å­˜
        </span>
        {% endif %}
      </div>
    </div>
  </div>
</div>
