# BOSS招聘助手 - 使用指南

## 目录

1. [安装与启动](#安装与启动)
2. [界面功能详解](#界面功能详解)
3. [常见问题](#常见问题)

---

## 安装与启动

### 在 macOS 上运行 .command 文件

#### 方法一：通过 Finder 双击运行（推荐）

1. **添加执行权限**
   
   首次使用前，需要在终端中为文件添加执行权限：
   
   ```bash
   chmod +x install_hr.command
   ```
   
   或者使用完整路径：
   ```bash
   chmod +x ~/Downloads/install_hr.command
   ```

2. **双击运行**
   
   - 在 Finder 中找到 `install_hr.command` 文件
   - 双击文件即可运行
   - 如果系统提示"无法打开，因为来自身份不明的开发者"，请：
     - 打开"系统偏好设置" → "安全性与隐私"
     - 点击"仍要打开"按钮

#### 方法二：通过终端运行

1. **打开终端**
   
   按 `Command + 空格键`，输入"终端"或"Terminal"，然后按回车

2. **导航到文件所在目录**
   
   ```bash
   cd ~/Downloads  # 根据实际文件位置调整路径
   ```

3. **添加执行权限（如未添加）**
   
   ```bash
   chmod +x install_hr.command
   ```

4. **运行脚本**
   
   ```bash
   ./install_hr.command
   ```

### 安装流程说明

运行 `install_hr.command` 后，脚本会自动执行以下步骤：

1. **检查并安装依赖**
   - 自动安装 `uv`（Python 包管理器）
   - 使用 `uv` 安装 Python 3.13

2. **克隆/更新代码仓库**
   - 如果目录不存在，会克隆仓库到 `~/bosszhipin_bot`
   - 如果目录已存在，会**丢弃所有本地修改**并拉取最新代码

3. **创建虚拟环境**
   - 自动创建 `.venv_hr` 虚拟环境
   - 安装所有 Python 依赖包

4. **配置环境**
   - 自动读取并生成 `.env` 和 `config/secrets.yaml` 文件
   - 使用预设的默认配置（OpenAI、Zilliz、DingTalk、Sentry 等）
   - 如果配置文件已存在，会保留现有配置

5. **启动服务**
   - 自动启动 Boss 招聘服务
   - 服务运行在 `http://127.0.0.1:5001`
   - Chrome 浏览器会自动弹出（CDP 模式）

### 访问 Web 界面

服务启动后，在浏览器中访问：

```
http://127.0.0.1:5001
```

**重要提示：**
- 首次启动 Chrome 时，需要在自动弹出的 Chrome 窗口中登录 Boss直聘账号
- 保持 Chrome 窗口打开，不要关闭
- 如果 Chrome 崩溃或关闭，重新运行安装脚本即可

---

## 界面功能详解

### 1. 首页

**访问路径：** `http://127.0.0.1:5001`

**功能说明：**

- **快速统计卡片**
  - 显示系统统计数据（候选人数量、对话数量等）
  - 数据自动刷新

- **功能入口卡片**
  - **手动招聘**：进入候选人管理界面
  - **自动化工作流**：配置和启动自动化流程（🚧 开发中）
  - **岗位画像**：管理招聘岗位信息
  - **API 文档**：查看完整的 REST API 文档

- **更新日志**
  - 显示系统最近的版本更新信息

**使用建议：**
- 首次使用建议先配置"岗位画像"，定义招聘需求
- 然后进入"手动招聘"查看和管理候选人
- 自动化工作流功能正在开发中，敬请期待

---

### 2. 手动招聘（候选人管理）

**访问路径：** `http://127.0.0.1:5001/candidates`

**功能说明：**

这是系统的核心功能模块，用于管理所有候选人。

#### 2.1 标签页说明

界面顶部有四个标签页，分别对应不同的候选人来源：

- **⭐ 推荐牛人**
  - 显示 Boss直聘系统推荐的候选人
  - 可以查看简历、分析匹配度、发送招呼

- **👋 新招呼**
  - 显示主动向您发送消息的候选人
  - 可以查看简历、分析匹配度、回复消息

- **💬 沟通中**
  - 显示正在沟通的候选人
  - 可以查看对话历史、发送消息、请求完整简历

- **📭 牛人已读未回**
  - 显示已读但未回复的候选人
  - 可以发送跟进消息

#### 2.2 筛选条件

- **岗位选择**
  - 从下拉菜单中选择要筛选的岗位
  - 不同岗位对应不同的岗位画像和筛选条件

- **沟通阈值**
  - 默认值：5.0
  - 含义：匹配度 ≥ 此分数时，系统会生成自动消息
  - 范围：1.0 - 10.0

- **及格线**
  - 默认值：7.0
  - 含义：匹配度 ≥ 此分数表示候选人有兴趣
  - 范围：1.0 - 10.0

- **强匹配阈值**
  - 默认值：9.0
  - 含义：匹配度 ≥ 此分数时，系统会要求获取联系方式
  - 范围：1.0 - 10.0

#### 2.3 候选人列表（左侧）

- **查询候选人**
  - 点击"🔍 查询候选人"按钮加载候选人列表
  - 列表会根据当前标签页和筛选条件显示候选人

- **候选人卡片**
  - 显示候选人姓名、头像、匹配度分数
  - 显示候选人状态（已分析、已发送消息等）
  - 点击卡片可在右侧查看详细信息

- **全部分析按钮**
  - 当选择候选人后，会显示"全部分析"按钮
  - 点击后会自动处理所有候选人：
    1. 加载在线简历（如未加载）
    2. 初始化对话（如未初始化）
    3. 进行 AI 分析（如未分析）
    4. 根据匹配度阈值自动生成消息或发送招呼
    5. 更新候选人卡片状态

#### 2.4 候选人详情（右侧）

点击左侧候选人卡片后，右侧会显示详细信息：

- **基本信息**
  - 姓名、头像、匹配度分数
  - 工作经历、教育背景

- **简历标签**
  - 显示系统自动提取的标签
  - 可以手动编辑标签

- **AI 分析结果**
  - 显示 AI 对候选人的分析
  - 包括匹配度评分、优势、劣势、建议等

- **对话历史**
  - 显示与候选人的所有对话记录
  - 可以查看消息发送时间、内容

- **操作按钮**
  - **查看在线简历**：在浏览器中打开候选人的在线简历
  - **查看完整简历**：下载并查看候选人的完整简历（附件）
  - **生成消息**：使用 AI 生成个性化消息
  - **发送消息**：向候选人发送消息
  - **请求简历**：向候选人请求完整简历

**使用流程：**

1. 选择岗位和设置阈值
2. 选择标签页（推荐牛人/新招呼/沟通中/牛人已读未回）
3. 点击"查询候选人"加载列表
4. 点击候选人卡片查看详情
5. 查看 AI 分析结果
6. 根据分析结果决定是否发送消息
7. 使用"生成消息"和"发送消息"功能与候选人沟通

---

### 3. 自动化工作流

**访问路径：** `http://127.0.0.1:5001/automation`

**状态：** 🚧 开发中

**功能说明：**

配置并启动自动化招聘流程，系统会自动处理候选人。此功能正在开发中，暂时不可用。

#### 3.1 远程访问 URL

- **用途**：提供给远程 LangGraph Agent 服务以访问此 API
- **获取方式**：
  - 如果已配置 Cloudflare Tunnel，会自动显示 URL
  - 如果没有配置，可以使用本地 URL：`http://127.0.0.1:5001`
  - 点击"🚀 启动 Cloudflare Tunnel"可以启动远程访问（需要安装 cloudflared）

#### 3.2 工作流配置

- **工作流类型选择**
  - **⭐ 推荐牛人**：自动处理推荐牛人列表
  - **💬 新招呼**：自动处理新收到的招呼（默认选中）
  - **🔥 沟通中**：自动处理正在沟通的候选人
  - **⏰ 追结果**：自动跟进已读未回的候选人

- **岗位选择**
  - 从下拉菜单中选择要处理的岗位

- **阈值设置**
  - **Borderline（及格线）**：默认 7.0，≥ 此分数表示兴趣
  - **Seek（强匹配阈值）**：默认 9.0，≥ 此分数要求联系方式

- **处理数量限制**
  - 默认值：20
  - 范围：5 - 100
  - 控制单次运行处理的候选人数量

#### 3.3 控制按钮

- **▶️ 启动**：启动自动化工作流
- **⏸️ 暂停**：暂停当前运行的工作流
- **⏭️ 下一步**：手动触发处理下一个候选人（仅在暂停状态下可用）
- **⏹️ 停止**：停止工作流
- **🗑️ 清空日志**：清空事件日志

#### 3.4 实时事件日志

- 显示工作流执行的实时日志
- 日志自动滚动到底部
- 不同级别的日志用不同颜色显示：
  - **信息**：白色
  - **警告**：黄色
  - **错误**：红色
  - **成功**：绿色

**使用流程：**

1. 选择要启用的工作流类型
2. 选择岗位
3. 设置阈值和处理数量
4. 点击"启动"按钮
5. 在事件日志中监控执行状态
6. 需要时可以使用"暂停"、"下一步"、"停止"按钮控制流程

**注意事项：**

- 自动化工作流会模拟人工操作，请确保 Chrome 浏览器已启动并登录
- 建议首次使用时设置较小的处理数量，观察效果后再调整
- 工作流运行期间不要关闭 Chrome 浏览器

---

### 4. 岗位画像

**访问路径：** `http://127.0.0.1:5001/jobs`

**功能说明：**

管理招聘岗位的背景、职责、要求和理想人选画像。这些信息用于 AI 分析候选人的匹配度。

#### 4.1 岗位列表

- 界面顶部显示所有岗位的标签页
- 点击标签页可以切换不同岗位
- 最后一个标签是"➕ 新增岗位"，用于创建新岗位

#### 4.2 基本信息

- **岗位 ID**：唯一标识符，创建后不可修改（例如：`python_developer`）
- **岗位名称**：岗位的显示名称（例如：`Python开发工程师`）

#### 4.3 岗位详情

- **公司背景**：描述公司背景和业务
- **主要职责**：描述岗位的主要职责
- **任职要求**：描述任职要求
- **岗位概述**：岗位的总体描述
- **理想人选**：描述理想人选的特征

#### 4.4 追问问题

- 用于面试沟通时进一步确认候选人能力与经历
- 一行一个问题
- 例如：
  ```
  请详细描述你在RLHF项目中的具体职责和贡献？
  你如何评估一个对齐算法的有效性？
  在工程实践中你如何权衡推理性能与成本？
  ```

#### 4.5 候选人筛选条件

- 用于在推荐页面筛选候选人的条件
- **格式**：JSON 格式
- **示例**：
  ```json
  {
    "活跃度": "本周活跃",
    "院校": ["985", "留学"],
    "只看第一学历": true,
    "学历": "硕士",
    "经验": "3-5年",
    "求职意向": ["离职-随时到岗", "在职-考虑机会"],
    "薪资待遇": "20-50K"
  }
  ```
- **功能按钮**：
  - **✨ 格式化**：自动格式化 JSON
  - **✓ 验证**：验证 JSON 格式是否正确

#### 4.6 关键词

- **正向关键词**：希望候选人具备的技能（蓝色标签）
- **负向关键词**：不希望候选人具备的技能（红色标签）

**使用方法：**

1. 在输入框中输入关键词
2. 按回车键或输入逗号/分号添加关键词
3. 点击标签上的 × 可以删除关键词

**使用建议：**

- 正向关键词示例：`Python`、`机器学习`、`深度学习`、`算法`
- 负向关键词示例：`Java`、`前端开发`（如果不希望候选人主要是前端背景）

#### 4.7 操作按钮

- **💾 保存**：保存当前岗位信息
- **🗑️ 删除岗位**：删除当前岗位（不可撤销）

**使用流程：**

1. 点击"➕ 创建新岗位"或选择已有岗位
2. 填写基本信息（岗位 ID 和岗位名称）
3. 详细填写岗位详情
4. 添加追问问题
5. 配置候选人筛选条件（JSON 格式）
6. 添加正向和负向关键词
7. 点击"保存"

**注意事项：**

- 岗位 ID 创建后不可修改，请谨慎填写
- 候选人筛选条件的 JSON 格式必须正确，可以使用"验证"按钮检查
- 关键词用于 AI 匹配，建议添加准确、相关的关键词

---

### 5. API 文档

**访问路径：** `http://127.0.0.1:5001/docs`

**功能说明：**

查看完整的 REST API 文档（Swagger UI）。

**功能特点：**

- 交互式 API 文档
- 可以直接在浏览器中测试 API
- 查看所有端点的详细说明
- 查看请求和响应示例

**适用场景：**

- 开发者集成系统
- 调试 API 问题
- 了解系统功能

---

## 常见问题

### 1. 如何添加执行权限？

如果双击 `.command` 文件无法运行，需要在终端中执行：

```bash
chmod +x install_hr.command
```

### 2. Chrome 连接失败怎么办？

**检查 Chrome 是否启动：**

```bash
curl http://127.0.0.1:9222/json/version
```

**如果未启动，执行：**

```bash
/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome --remote-debugging-port=9222 --user-data-dir=/tmp/chrome_debug
```

**如果仍然失败，清除缓存后重启：**

```bash
rm -rf /tmp/chrome_debug
# 然后重新启动 Chrome
```

### 3. 服务无法启动怎么办？

1. **检查端口是否被占用：**
   ```bash
   lsof -i :5001
   ```

2. **检查配置文件：**
   - 确认 `.env` 文件存在且配置正确
   - 确认 `config/secrets.yaml` 文件存在且配置正确

3. **查看错误日志：**
   - 在终端中查看服务启动时的错误信息
   - 检查是否有依赖包未安装

### 4. 如何更新代码？

运行 `install_hr.command` 脚本会自动更新代码。脚本会：
- 丢弃所有本地修改
- 拉取最新的代码
- 重新安装依赖（如有更新）

### 5. 登录失效怎么办？

删除登录状态文件并重新登录：

```bash
rm ~/bosszhipin_bot/data/state.json
```

然后重新启动 Chrome 并登录 Boss直聘账号。

### 6. 如何修改服务端口？

编辑 `config/config.yaml` 文件，修改 `service.port` 的值：

```yaml
service:
  host: 127.0.0.1
  port: 5001  # 修改为其他端口
```

### 7. AI 分析不准确怎么办？

1. **检查岗位画像配置：**
   - 确保岗位详情填写完整
   - 确保关键词设置准确

2. **调整阈值：**
   - 在候选人管理界面调整沟通阈值、及格线、强匹配阈值

3. **手动编辑标签：**
   - 在候选人详情页面可以手动编辑标签

### 8. 自动化工作流不工作怎么办？

1. **检查 Chrome 是否运行：**
   - 确保 Chrome 浏览器已启动并登录

2. **检查工作流配置：**
   - 确认已选择工作流类型
   - 确认已选择岗位

3. **查看事件日志：**
   - 在自动化工作流界面查看实时日志
   - 根据错误信息排查问题

### 9. 如何重置系统？

1. **停止服务：**
   - 在终端中按 `Ctrl + C` 停止服务

2. **清除数据：**
   ```bash
   rm -rf ~/bosszhipin_bot/data/state.json
   rm -rf /tmp/chrome_debug
   ```

3. **重新启动：**
   - 重新运行 `install_hr.command`
   - 重新启动 Chrome 并登录

---

## 技术支持

如遇到问题，可以：

1. 查看系统日志
2. 检查 Sentry 错误追踪（如已配置）
3. 查看 API 文档了解详细功能
4. 联系技术支持

---

**最后更新：** 2024-10-11  
**版本：** v2.4.0

